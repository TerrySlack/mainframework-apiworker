{"version":3,"file":"jest.worker-setup.js","sourceRoot":"","sources":["jest.worker-setup.ts"],"names":[],"mappings":"AAAA;;;GAGG;AAEH,MAAM,eAAe,GAAG,IAAI,CAAC,EAAE,EAG5B,CAAC;AACJ,IAAI,gBAAgB,GAAuC,IAAI,CAAC;AAEhE,MAAM,kBAAkB,GAAG;IACzB,WAAW,EAAE,eAAe;IAC5B,IAAI,SAAS;QACX,OAAO,gBAAgB,CAAC;IAC1B,CAAC;IACD,IAAI,SAAS,CAAC,EAAsC;QAClD,gBAAgB,GAAG,EAAE,CAAC;IACxB,CAAC;IACD,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;IACpB,gBAAgB,EAAE,IAAI,CAAC,EAAE,EAAE;IAC3B,mBAAmB,EAAE,IAAI,CAAC,EAAE,EAAE;IAC9B,aAAa,EAAE,IAAI,CAAC,EAAE,EAAE;CACzB,CAAC;AAEF,SAAS,UAAU;IACjB,OAAO,kBAAkB,CAAC;AAC5B,CAAC;AAED,MAAM,UAAU,GAAG;IACjB,mBAAmB,EAAE,GAAgB,EAAE,CAAC,eAAe,CAAC,IAAI,CAAC,KAAoB;IACjF,gBAAgB,EAAE,GAAG,EAAE,CAAC,eAAe,CAAC,SAAS,EAAE;IACnD,6DAA6D;IAC7D,eAAe,CAAC,OAAgC;QAC9C,IAAI,gBAAgB,EAAE,CAAC;YACrB,gBAAgB,CAAC,EAAE,IAAI,EAAE,OAAO,EAAkB,CAAC,CAAC;QACtD,CAAC;IACH,CAAC;IACD,IAAI,WAAW;QACb,OAAO,eAAe,CAAC;IACzB,CAAC;CACF,CAAC;AAED,UAAmD,CAAC,MAAM,GAAG,UAAsC,CAAC;AACpG,UAAgE,CAAC,eAAe,GAAG,UAAU,CAAC;AAE/F,8DAA8D;AAC7D,UAAyD,CAAC,iBAAiB,GAAG,KAAK,CAAC","sourcesContent":["/**\r\n * Mocks global Worker so useApiWorker tests can run without a real worker.\r\n * Tests can simulate worker responses via __WORKER_MOCK__.dispatchMessage(payload).\r\n */\r\n\r\nconst mockPostMessage = jest.fn<\r\n  ReturnType<typeof Worker.prototype.postMessage>,\r\n  Parameters<typeof Worker.prototype.postMessage>\r\n>();\r\nlet onmessageHandler: ((e: MessageEvent) => void) | null = null;\r\n\r\nconst mockWorkerInstance = {\r\n  postMessage: mockPostMessage,\r\n  get onmessage() {\r\n    return onmessageHandler;\r\n  },\r\n  set onmessage(fn: ((e: MessageEvent) => void) | null) {\r\n    onmessageHandler = fn;\r\n  },\r\n  terminate: jest.fn(),\r\n  addEventListener: jest.fn(),\r\n  removeEventListener: jest.fn(),\r\n  dispatchEvent: jest.fn(),\r\n};\r\n\r\nfunction MockWorker(this: typeof mockWorkerInstance) {\r\n  return mockWorkerInstance;\r\n}\r\n\r\nconst workerMock = {\r\n  getPostMessageCalls: (): unknown[][] => mockPostMessage.mock.calls as unknown[][],\r\n  clearPostMessage: () => mockPostMessage.mockClear(),\r\n  /** Simulate a message from the worker (success or error). */\r\n  dispatchMessage(payload: Record<string, unknown>) {\r\n    if (onmessageHandler) {\r\n      onmessageHandler({ data: payload } as MessageEvent);\r\n    }\r\n  },\r\n  get postMessage() {\r\n    return mockPostMessage;\r\n  },\r\n};\r\n\r\n(globalThis as unknown as { Worker: typeof Worker }).Worker = MockWorker as unknown as typeof Worker;\r\n(globalThis as unknown as { __WORKER_MOCK__: typeof workerMock }).__WORKER_MOCK__ = workerMock;\r\n\r\n// Rely on native fetch (Node 18+; this project uses Node 24).\r\n(globalThis as unknown as { __FETCH_IS_STUB__?: boolean }).__FETCH_IS_STUB__ = false;\r\n"]}