{"version":3,"file":"types.js","sourceRoot":"","sources":["types.ts"],"names":[],"mappings":"","sourcesContent":["import type { Dispatch, SetStateAction } from \"react\";\n\n/** When \"binary\" or \"stream\", in-flight dedupe is skipped so we always run the request and return real response (no stale). */\nexport type ResponseType = \"json\" | \"binary\" | \"stream\";\n\nexport interface RequestConfig {\n  url: string;\n  method: \"GET\" | \"get\" | \"POST\" | \"post\" | \"PATCH\" | \"patch\" | \"DELETE\" | \"delete\";\n  mode?: \"cors\" | \"no-cors\" | \"navigate\" | \"same-origin\";\n  headers?: Record<string, string>;\n  credentials?: \"include\" | \"same-origin\" | \"omit\";\n  /** Omit or \"json\": allow in-flight dedupe. \"binary\" or \"stream\": no early return, always process request. */\n  responseType?: ResponseType;\n  /** Abort request after this many milliseconds. */\n  timeoutMs?: number;\n  /** FormData field name for File/Blob parts. Default \"Files\". */\n  formDataFileFieldName?: string;\n}\n\nexport type RunMode = \"auto\" | \"manual\" | \"once\";\n\nexport interface UseApiWorkerConfig {\n  cacheName: string;\n  request?: RequestConfig;\n  data?: unknown;\n  runMode?: RunMode;\n  enabled?: boolean;\n}\n\nexport type WorkerDataRequestType = \"get\" | \"set\" | \"delete\" | \"cancel\";\n\nexport type WorkerApiRequest = RequestConfig;\n\nexport interface DataRequest<T = unknown> {\n  hookId?: string;\n  cacheName?: string;\n  type: WorkerDataRequestType;\n  payload?: T;\n  request?: WorkerApiRequest;\n  /** Required for cancel, optional for set (enables cancellation). */\n  requestId?: string | null;\n}\n\nexport interface BinaryResponseMeta {\n  contentType?: string;\n  contentDisposition: string | null;\n}\n\n/** Type-only: binary parse results use Symbol.for(\"WorkerApiBinary\"). Value lives in api.worker. */\ndeclare const BINARY_MARKER: unique symbol;\n\nexport type BinaryParseResult = {\n  [BINARY_MARKER]: true;\n  data: ArrayBuffer;\n  contentType: string;\n} & Pick<BinaryResponseMeta, \"contentDisposition\">;\n\nexport type WorkerErrorKind = \"http\" | \"network\" | \"validation\";\n\nexport interface WorkerError {\n  kind: WorkerErrorKind;\n  message: string;\n  status?: number;\n  code?: string;\n}\n\nexport interface QueueEntry<T> {\n  hookId: string;\n  cacheName: string;\n  loading: boolean | null;\n  data: T | null;\n  meta: BinaryResponseMeta | null;\n  error: WorkerError | null;\n  setUpdateTrigger: Dispatch<SetStateAction<number>> | null;\n  requestId: string | null;\n  lastActivityAt: number | null;\n}\n\nexport interface UseApiWorkerReturn<T> {\n  data: T | null;\n  meta: BinaryResponseMeta | null;\n  loading: boolean;\n  error: WorkerError | null;\n  refetch: () => void;\n  deleteCache: () => void;\n}\n\nexport type AbortControllers = Map<string, AbortController>;\n\n/**\n * Worker response messages. Use in client onmessage handler:\n * - data + meta: binary response (data is ArrayBuffer). Reconstruct: new Blob([data], { type: meta?.contentType })\n * - data only: JSON/text response\n * - error: error response with message and code\n */\nexport type WorkerResponseMessage =\n  | { cacheName: string; data: unknown }\n  | { cacheName: string; data: ArrayBuffer; meta: BinaryResponseMeta }\n  | { cacheName: string; error: WorkerError };\n\n/**\n * Payload shape for worker postMessage. Use for client onmessage:\n * MessageEvent<WorkerMessagePayload>. Success: data = body. Error: data = WorkerError (kind, message, status?, code?).\n */\nexport interface WorkerMessagePayload {\n  cacheName?: string;\n  /** Response body or error payload (WorkerError when kind is \"http\"|\"network\"|\"validation\"). */\n  data?: unknown;\n  meta?: BinaryResponseMeta;\n  error?: WorkerError;\n  hookId?: string;\n  httpStatus?: number;\n}\n\nexport interface StackArray {\n  key: string;\n  value: unknown;\n}\n\n//Use this in the hook to show the engineer what kind of content type to use\nexport type ContentType =\n  // Application types\n  | \"application/json\"\n  | \"application/xml\"\n  | \"application/x-www-form-urlencoded\"\n  | \"application/pdf\"\n  | \"application/zip\"\n  | \"application/gzip\"\n  | \"application/octet-stream\"\n  | \"application/javascript\"\n  | \"application/ld+json\"\n  | \"application/vnd.api+json\"\n  | \"application/vnd.ms-excel\"\n  | \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n  | \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\n  | \"application/vnd.openxmlformats-officedocument.presentationml.presentation\"\n  // Text types\n  | \"text/plain\"\n  | \"text/html\"\n  | \"text/css\"\n  | \"text/csv\"\n  | \"text/javascript\"\n  | \"text/xml\"\n  // Image types\n  | \"image/jpeg\"\n  | \"image/png\"\n  | \"image/gif\"\n  | \"image/svg+xml\"\n  | \"image/webp\"\n  | \"image/bmp\"\n  | \"image/tiff\"\n  | \"image/x-icon\"\n  | \"image/avif\"\n  // Audio types\n  | \"audio/mpeg\"\n  | \"audio/ogg\"\n  | \"audio/wav\"\n  | \"audio/webm\"\n  | \"audio/aac\"\n  | \"audio/midi\"\n  // Video types\n  | \"video/mp4\"\n  | \"video/mpeg\"\n  | \"video/webm\"\n  | \"video/ogg\"\n  | \"video/quicktime\"\n  | \"video/x-msvideo\"\n  // Multipart types\n  | \"multipart/form-data\"\n  | \"multipart/mixed\"\n  | \"multipart/alternative\"\n  // Font types\n  | \"font/woff\"\n  | \"font/woff2\"\n  | \"font/ttf\"\n  | \"font/otf\";\n"]}